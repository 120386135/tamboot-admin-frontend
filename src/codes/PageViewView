import React, { PureComponent } from 'react';
import { connect } from 'dva';
import { Card, Input, Button, message } from 'antd';
import PageHeaderWrapper from '@/components/PageHeaderWrapper';
import PageView from '@/components/PageView';

@connect(({systemUser, loading}) => ({
    systemUser,
    pageViewLoading: loading.effects['systemUser/page']
}))
class PageViewView extends PureComponent {
    render() => {
        const {
            dispatch,
            systemUser: { pageData },
            pageViewLoading
        } = this.props;

        const columns = [
            {title: 'ID', dataIndex: 'id'},
            {title: '用户名', dataIndex: 'username'},
            {title: '角色', dataIndex: 'roleNameList', render: (val) => (val.join(','))}
        ]

        const searchFormItems = [
            {label: '用户名', name: 'usernameLike', component: <Input placeholder='支持模糊查询'/>}
        ]

        const operatorComponents = [
            <Button type="batchEnable" icon="check" onClick={this.handleBatchEnable}>启用</Button>   
        ]

        return (
            <PageHeaderWrapper>
                <PageView
                    loading={pageViewLoading}    
                    dispatch={dispatch}
                    pageData={pageData}
                    pageEffectType="systemUser/page"
                    columns={columns}
                    searchFormItems={searchFormItems}
                    operatorComponents={operatorComponents}
                    selectable={true}
                    bindGetSelectedRows={(func) => this.getSelectedRows = func}
                >
                </PageView>
            </PageHeaderWrapper>
        )
    }

    handleBatchEnable = () => {
        const selectedRows = this.getSelectedRows();
        if (!selectedRows || selectedRows.length === 0) {
            message.warning('请勾选要启用的数据');
            return;
        }
        
        message.success('已启用');
    }
}

export default PageViewView;